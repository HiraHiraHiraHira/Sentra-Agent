{
  "name": "sandbox_exec",
  "description": "在受控沙箱终端中执行命令，并流式返回执行过程。默认联动 sentra-config-ui 的 PTY 终端执行器。",
  "inputSchema": {
    "type": "object",
    "properties": {
      "cmd": {
        "type": "string",
        "description": "要执行的命令（非交互）。尽量使用单条命令；需要多条时用 &&（Windows cmd）或 ;（bash）等连接。"
      },
      "terminalType": {
        "type": "string",
        "description": "可选：终端类型（shellType）。不传则回退到 SANDBOX_EXEC_TERMINAL_TYPE。",
        "enum": [
          "powershell",
          "cmd",
          "bash",
          "zsh",
          "sh"
        ]
      },
      "cwd": {
        "type": "string",
        "description": "可选：工作目录（绝对路径优先）。不传则使用服务端默认 cwd。"
      },
      "timeoutMs": {
        "type": "number",
        "description": "可选：等待命令完成的超时时间（毫秒）。到期会尝试关闭会话。"
      },
      "expectExit": {
        "type": "boolean",
        "description": "可选：是否期望命令自然退出。默认 true。对于 pm2 logs / tail -f 等持续输出命令，应设为 false，让插件在 timeoutMs 到期时返回部分输出。"
      },
      "stopSignal": {
        "type": "string",
        "description": "可选：当 expectExit=false 且到达 timeoutMs 时，用什么方式停止命令。默认 ctrl_c。",
        "enum": [
          "ctrl_c",
          "none"
        ]
      },
      "closeOnFinish": {
        "type": "boolean",
        "description": "可选：命令执行结束后是否自动关闭终端会话。默认 true。"
      },
      "stripAnsi": {
        "type": "boolean",
        "description": "可选：是否清理 ANSI 转义序列（颜色/光标控制等）。默认 true。设为 false 可保留原始终端转义码。"
      },
      "encoding": {
        "type": "string",
        "description": "可选：输出编码。默认 utf-8。Windows cmd/powershell 可能需要 gbk。"
      },
      "maxOutputChars": {
        "type": "number",
        "description": "可选：最大输出字符数，超出会裁剪保留最后部分。0 表示不限制。"
      },
      "tailLines": {
        "type": "number",
        "description": "可选：只返回最后 N 行。0 表示不限制。优先于 maxOutputChars。"
      },
      "schedule": {
        "type": "object",
        "properties": {
          "when": {
            "type": "string",
            "description": "时间表达：如 '5分钟后' / '30秒后' / '明天09:00' / '2025-12-16 21:30' / ISO 字符串。请使用清晰、可解析的时间表达，避免使用『稍后』『改天』『有空的时候』『尽快』『5分钟之后』等模糊说法。"
          },
          "language": {
            "type": "string",
            "description": "语言标识，例如 zh|en（默认 zh）"
          },
          "timezone": {
            "type": "string",
            "description": "IANA 时区名称，例如 Asia/Shanghai"
          },
          "targetISO": {
            "type": "string",
            "description": "预解析好的绝对时间（ISO 字符串），例如 '2025-12-16T21:30:00+08:00'；如提供，将被上游优先用作目标时间。"
          }
        },
        "required": [
          "when",
          "targetISO"
        ],
        "additionalProperties": true,
        "description": "可选：当用户需要延迟处理或延迟反馈时使用。具体是仅延迟反馈还是到点再执行，由上层调度策略（例如 immediate_exec / delayed_exec）决定；若到点未完成，将先反馈进行中状态。"
      }
    },
    "required": [
      "cmd"
    ],
    "additionalProperties": true
  },
  "timeoutMs": 300000,
  "meta": {
    "streamSupport": true
  }
}